generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String                        @default(uuid())
  username      String                        @unique
  wallet        String                        @id @unique
  blinkCreated  Boolean                       @default(false)
  createdAt     DateTime                      @default(now())
  updatedAt     DateTime                      @updatedAt

  payments      UserReceivedSolTransactions[]
  blink         UserBlink?

  @@index([username], name: "username_user")
  @@index([wallet], name: "wallet_user")
}

model UserReceivedSolTransactions {
  id           String   @id @default(uuid())
  amount       Float
  wallet       String
  referenceKey String
  transactionId String?
  status       Status   @default(PENDING)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  userWallet   String
  user         User     @relation(fields: [userWallet], references: [wallet])

  @@index([wallet], name: "wallet_address_sender")
  @@index([referenceKey], name: "reference_key_transaction")
}

model UserBlink {
  id          String  @id @default(uuid())
  title       String
  icon        String  
  description String
  label String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  userWallet  String  @unique
  user        User    @relation(fields: [userWallet], references: [wallet])

  @@index([userWallet],name:"user_wallet_address")
}

enum Status {
  PENDING
  PAID
  FAILED
}
